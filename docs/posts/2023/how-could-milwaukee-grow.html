<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mike Gousha and John Johnson">
<meta name="dcterms.date" content="2023-03-08">

<title>What’s the path for Milwaukee to reverse population loss? – John Johnson's Internet Archive</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-bde7cfe73309ee1b4eca639e0a08c217.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">John Johnson’s Internet Archive</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Table of Contents</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../external-links.html"> 
<span class="menu-text">External Links</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://bluebookmke.substack.com/"> 
<span class="menu-text">Blue Book Newsletter</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-machine-shop-of-the-world-was-once-one-of-americas-largest-cities" id="toc-the-machine-shop-of-the-world-was-once-one-of-americas-largest-cities" class="nav-link active" data-scroll-target="#the-machine-shop-of-the-world-was-once-one-of-americas-largest-cities">‘The machine shop of the world’ was once one of America’s largest cities</a></li>
  <li><a href="#many-midwestern-cities-experiencing-population-loss-over-decades" id="toc-many-midwestern-cities-experiencing-population-loss-over-decades" class="nav-link" data-scroll-target="#many-midwestern-cities-experiencing-population-loss-over-decades">Many Midwestern cities experiencing population loss over decades</a></li>
  <li><a href="#milwaukee-population-loss-and-growth-varies-across-the-city" id="toc-milwaukee-population-loss-and-growth-varies-across-the-city" class="nav-link" data-scroll-target="#milwaukee-population-loss-and-growth-varies-across-the-city">Milwaukee population loss, and growth, varies across the city</a></li>
  <li><a href="#there-are-plenty-of-ideas-for-how-milwaukee-can-grow-again" id="toc-there-are-plenty-of-ideas-for-how-milwaukee-can-grow-again" class="nav-link" data-scroll-target="#there-are-plenty-of-ideas-for-how-milwaukee-can-grow-again">There are plenty of ideas for how Milwaukee can grow again</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">What’s the path for Milwaukee to reverse population loss?</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Mike Gousha and John Johnson </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 8, 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><em>This article <a href="https://www.jsonline.com/story/news/solutions/2023/03/08/whats-path-for-milwaukee-to-reverse-population-decline-grow-again/69959649007/">originally appeared</a> in the Milwaukee Journal Sentinel.</em></p>
<p>“Make no little plans. They have no magic to stir men’s blood…”</p>
<p>When renowned Chicago architect and urban planner Daniel Burnham uttered those famous words more than a century ago, American cities were in a period of rapid growth.</p>
<p>Today, some cities in the south and southwest are seeing their populations soar. But more than a few proud American cities are shrinking, shedding thousands of residents. Milwaukee is one of them.</p>
<p>Mayor Cavalier Johnson hopes to reverse that trend. More than 100 years after Daniel Burnham’s exhortation, Johnson is making big plans of his own.</p>
<p>He wants Milwaukee to grow. A lot.</p>
<p>During his campaign for mayor, Johnson raised a few eyebrows when he talked about the city increasing its population to one million people, nearly twice its current size.</p>
<p>It is not just that Johnson wants Milwaukee to grow. He needs population and business growth to help relieve enormous pressure on the city’s long-term finances.</p>
<p>But you sense that Johnson’s moonshot for Milwaukee is about more than aspiring to grow; it is about inspiring a city to reimagine itself, to think differently about its future.</p>
<section id="the-machine-shop-of-the-world-was-once-one-of-americas-largest-cities" class="level2">
<h2 class="anchored" data-anchor-id="the-machine-shop-of-the-world-was-once-one-of-americas-largest-cities">‘The machine shop of the world’ was once one of America’s largest cities</h2>
<p>Milwaukee’s past is a colorful one, filled with periods of industrial innovation and political experimentation. In the first half of the 1900s, the city was known as “the machine shop of the world” and elected <a href="https://www.wuwm.com/regional/2019-03-15/how-did-socialist-mayors-impact-milwaukee">three socialist mayors</a>.</p>
<p>It was also, for a time, one of the largest cities in America. Fueled first by German and Polish immigration and later by the arrival of Black families from the south, Milwaukee’s population reached its peak in 1960, when census data showed a city of more than 741,000 residents. That made it the 11th largest city in America. Today, it is 31st. Since 1970, except for a slight uptick in the early 2010s, the city’s population has been steadily declining.</p>
<p>According to the Census Bureau, the city’s population fell 17,600 since 2010 to just over 577,000 in 2020.</p>
<p>In December, the city of Milwaukee filed a formal challenge to the 2020 census count, arguing the Bureau undercounted Milwaukee. It cited a number of reasons, including misplaced prisoners and 2,394 missed housing units. The Census Bureau has since agreed that about 800 incarcerated people were incorrectly counted outside the city, but they have not yet released on a decision on the housing units. After <a href="https://law.marquette.edu/facultyblog/2023/01/assessing-the-city-of-milwaukees-2020-census-challenge/">carefully reviewing the evidence</a>, we conclude that a 6,000 person undercount is plausible. Serious concerns remain about undercounts of Black and Latino residents across the country, and it is possible that these Milwaukeeans were undercounted in both 2010 and 2020.</p>
<p>Nonetheless, even if the baseline counts are in error, the direction of population change is more certain. All the best data, including vital statistics and migration flows, points to a population decline in the city over the past decade.</p>
<p>Our review of data since the 2020 census shows that downward trajectory accelerated during the pandemic. From the census in the spring of 2020 to July of 2021, the Census Bureau estimates the city’s population declined another 7,900.</p>
<p>Interestingly, the metropolitan Milwaukee area’s population also fell during the pandemic period, with the Census Bureau estimating a decrease of 9,000 in the metro. That is the first decline in decades. It is unclear if the population loss during the pandemic reflects a temporary or more permanent change in how and where work is being done.</p>
<p>Still, the optics of Milwaukee’s population decline can be deceiving. In some places, it looks and feels like the city is growing. The city saw an explosion of new apartment buildings and condominiums in the last two decades. The apartment building boom continues. Right now, construction is underway on a 44-story tower near the Milwaukee Art Museum. A 31-story apartment building is rising on the northwestern edge of the city’s Third Ward.</p>
<p>The number of occupied housing units in the city increased by 5,000 in the last decade. So, how can our population be declining?</p>
<p>The answer lies in shrinking household sizes in Milwaukee. Most of the new housing units in Milwaukee were smaller apartments with one or two people living in them. Citywide, the typical household size fell from 2.5 in 2010 to 2.39 in 2020.</p>
<p>That change is largely the result of declining birthrates in the last decade. Birth certificate records show that 117,000 babies were born to Milwaukee mothers in the 1990s, falling to 112,000 in the 2000s, and 98,000 in the 2010s.</p>
<p>The shrinking size of the typical Milwaukee household points to the challenges of changing the city’s growth trajectory.</p>
<p>Cities shrink because of two factors: negative natural change—more deaths than births—or net migration.</p>
<p>For now, Milwaukee still has more births than death, although that gap is rapidly closing. But we lost tens of thousands of residents to migration in the last decade.</p>
</section>
<section id="many-midwestern-cities-experiencing-population-loss-over-decades" class="level2">
<h2 class="anchored" data-anchor-id="many-midwestern-cities-experiencing-population-loss-over-decades">Many Midwestern cities experiencing population loss over decades</h2>
<p>Milwaukee is not the only Midwestern city to <a href="https://www.foxbusiness.com/lifestyle/why-midwestern-cities-shrinking">lose residents</a>. In the last decade, Cleveland’s population fell 24,000 to 372,000. Only 30 years ago, Detroit had more than 1,000,000 residents. In 2020, it had 639,000, losing another 75,000 in just the last decade. St.&nbsp;Louis’s population declined by 18,000 to 301,000.</p>
<p>Overall growth in the St.&nbsp;Louis, Cleveland, and Milwaukee metros was close to zero.</p>
<p>But population loss is not inevitable for older, Midwestern or industrial cities. After decades of declining population, places like Cincinnati and Buffalo experienced growth in the last decade. Cincinnati added 12,000 residents. Buffalo, 17,000.</p>
<p>Population growth—both city and metro—was even greater in Kansas City, Indianapolis, and Columbus. Looking at just the cities (not the metros), Kansas City added nearly 50,000 residents in the last decade. Indianapolis grew by 67,000. The city of Columbus added more than 110,000 residents.</p>
<p>All three of those cities have several things in common. They have modest gains from international migration. With the possible pandemic-related exception of 2021, they have positive natural change (more births than deaths), although that is slowly dwindling.</p>
<p>What sets them apart from Milwaukee, Cleveland, and St.&nbsp;Louis is domestic migration. While thousands of residents left Milwaukee, Cleveland, and St.&nbsp;Louis in the last decade, thousands more Americans were moving to Kansas City, Indianapolis, and Columbus.</p>
</section>
<section id="milwaukee-population-loss-and-growth-varies-across-the-city" class="level2">
<h2 class="anchored" data-anchor-id="milwaukee-population-loss-and-growth-varies-across-the-city">Milwaukee population loss, and growth, varies across the city</h2>
<p>Still, the story of population loss in Milwaukee is more nuanced than you might think. It is not a city-wide phenomenon.</p>
<p>We looked at population growth and loss by aldermanic district in Milwaukee (we did this by aggregating census blocks from 2000 into the district boundaries drawn earlier this year). In the last two decades there was significant population growth in three aldermanic districts, the 3rd (east side), the 4th, (downtown) and the 13th (far south side).</p>
<p>The 3rd and 4th districts grew because of strong demand for new housing units being built there. The 13th district grew by increasing its typical household size, likely the result of immigrant families moving into neighborhoods. Together, these three districts added more than 12,000 over the past 20 years.</p>
<p>Another three districts saw modest, but noticeable growth. They were the 5th (northwest fringe), the 8th (near south side), and the 11th (far southwest side). Together, these districts grew by about 4,500 residents over the last 20 years, in large part due to an increase in household sizes.</p>
<p>The 9th (far northwest side) and 14th (greater Bay View) stayed about the same in terms of total population.</p>
<p>The city’s remaining seven districts, all but one on the north side, account for all the city’s population loss. The 15th lost 23% of its population in the last two decades. The adjacent 6th district saw a population loss of 18%, followed by a 15% decline in the 7th, 10% in the 1st, and 8% in the 2nd.</p>
<p>Both the 10th and 12th districts declined 5%.</p>
<p>All told, these seven districts lost 12% of their population since 2000, a decline of 37,700 people. It is the result of shrinking household sizes and decline in the total number of households. Even among the remaining housing units, there are sky high vacancy rates.</p>
<p>The city argues that the 2020 census undercounted housing units in the 6th, 7th, and 15th districts on the near north side. If true, this still would not change the long-term trend. Our analysis shows that the population in these neighborhoods has been declining for decades—down by nearly 55,000 since 1980.</p>
<p>The dueling narratives—population growth and loss—tell us something about the opportunities for growth in Milwaukee, as well as the obstacles to achieving it.</p>
</section>
<section id="there-are-plenty-of-ideas-for-how-milwaukee-can-grow-again" class="level2">
<h2 class="anchored" data-anchor-id="there-are-plenty-of-ideas-for-how-milwaukee-can-grow-again">There are plenty of ideas for how Milwaukee can grow again</h2>
<p>So, how could the city begin growing again? Here are some ideas popular with leading urban planners, designers, and policy experts. A number of them are already being pursued or explored by Milwaukee’s policymakers.</p>
<p>The city can start by continuing to encourage development where people want to live. Low vacancy rates indicate demand is still strong for housing in the downtown, east side, Walker’s Point, and Bay View areas.</p>
<p>When possible, the city should encourage refugee and immigrant settlement. Parts of the far south side have seen population growth, in large part because of higher birth rates among immigrant families. For example, Buffalo attributes some of its recent population growth to new international arrivals in the city. Given shrinking household sizes among native-born Americans, immigration by larger families is the main way neighborhoods can grow without building more houses.</p>
<p>Milwaukee can increase domestic migration by offering newcomers a city that is more pedestrian and bike-friendly, with more public spaces and easy access to transit options. Zoning changes can increase density in areas that have experienced population loss because of shrinking household size. Where housing is in demand, more of it should be built. At the turn of the 20th century, Milwaukee was one of the most densely populated cities in America. A return to its roots—with better planning—might be in order.</p>
<p>But even doing all those things, important as they are, still will not address the primary cause of Milwaukee’s recent population loss — depopulation of neighborhoods across the north side.</p>
<p>The community, including the broader metro, must reduce racial disparities. The city could stem much of its population loss if more residents — increasingly those of color — chose to remain in Milwaukee. Public investment should be prioritized for neighborhoods that have experienced decades of disinvestment and population decline.</p>
<p>The city should continue to build on the recent decisions by Fiserv and Milwaukee Tool to move their corporate headquarters and hundreds of jobs from the suburbs to downtown Milwaukee. Their relocations and Northwestern Mutual’s recent decision to move jobs from its Franklin campus to downtown serve as a powerful reminder of Milwaukee’s built-in recruiting advantage with today’s employers; the city is more attractive to a younger, diverse workforce, some of whom will want to live in the city, close to where they work.</p>
<p>And Milwaukee can play to its other strengths. Our climate and access to abundant freshwater may blunt some of the worst effects of climate change. The quality of life available to middle class families is superior to that in many of the fastest growing cities, where cost-of-living increases outstrip the wages of most workers. For example, a recent study found that Milwaukee was among the most affordable metros for starting teacher salaries.</p>
<p>Still, serious obstacles to population growth remain.</p>
<p>At the top of the list is public safety. The city has seen an epidemic of reckless driving and just recorded its third straight year of record homicides. Perhaps not surprisingly, the areas hit the hardest by the violence in Milwaukee have seen the greatest population decline. While some growing cities such as Kansas City and Indianapolis also have higher rates of violent crime, public safety plays an important role in why people choose to live in a city. It is worth noting that three of the most dangerous cities in America — Baltimore, Detroit, and Memphis — experienced some of the greatest population loss in the last decade.</p>
<p>Without new sources of revenue, Milwaukee will find it difficult, if not impossible, to provide quality services and amenities. And if basic services decline, Milwaukee is a less attractive place to live for current and potential residents who already pay one of the highest property tax rates in southeastern Wisconsin. Many other large cities have more revenue streams available to them.</p>
<p>While Milwaukee offers a variety of educational options for families—public, charters, and vouchers—too many of the city’s schools struggle to meet basic academic achievement standards, a disincentive for families considering where to live.</p>
<p>And finally, is there enough economic growth in Milwaukee to create population growth? As we have reported, metro Milwaukee recovered from the last recession more slowly than some peer cities, with many of the new jobs created in lower-wage occupations. As part of “The American Growth Project,” a recent study from the Kenan Institute of Private Enterprise at the University of North Carolina ranked the 50 largest cities (metros) by speed of economic growth in 2022. Milwaukee finished last.</p>
<p>When we first wrote about stagnant population growth in metro Milwaukee a couple of years ago, some readers wondered whether growth was the best way to measure the vitality of a city.</p>
<p>It is a fair question. In the 2020 census, Pittsburgh was a city of about 300,000 people, less than half the size it was in 1950. It has reinvented itself as a major technology hub and ranks highly in surveys that measure quality of life. A smaller city, the argument goes, does not have to be lesser city.</p>
<p>So, which path should Milwaukee take?</p>
<p>Mayor Johnson is betting on growth. One million Milwaukeeans.</p>
<p>Call it a bold vision for the future or an impossible dream. But if Daniel Burnham—the author of “make no little plans”—were alive today, you suspect he just might be smiling.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>